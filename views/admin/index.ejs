<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js dev" lang="en"> <!--<![endif]-->
<head>
    <title>Developer Factory</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="../images/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
    <link rel="stylesheet" href="../stylesheets/bootstrap.min.css" />
    <link rel="stylesheet" href="../stylesheets/dev.css" />
    <link href="http://fonts.googleapis.com/css?family=Titillium+Web:200,300,400" rel="stylesheet" type="text/css">
    <script data-main="../js/admin" src="../js/libs/require.js"></script>
</head>
<body>
<div id="site-header">
    <div class="logo_container">
        <a href="../">
            <img src="../images/heading.png" alt="Developer Factory" /><h4>Developer Factory Administrator</h4>
        </a>
    </div>
    <div class="control-buttons hidden">
        <a href="#" id="user-panel-toggle"><i class="icon-chevron-down icon-white"></i><span id="username-placeholder"></span></a>
    </div>
</div>
<div id="user-panel" style="display:none">
    <div class="col">
        <span class="user-username"></span><br />
        <span class="user-company"></span>
    </div>
    <div class="btns">
        <a href="#/logout" class="btn btn-primary">Log Out</a>
    </div>
</div>
</div>
<div id="admin" class="page hidden">
    <div class="row-fluid">
        <div class="span1"></div>
        <div class="span10 page-view">
            <ul class="nav nav-tabs">
              <li id="mgmt-users-tab" class="active"><a href="#/users">Users</a></li>
              <li id="mgmt-invites-tab"><a href="#/invites">Pending</a></li>
              <li id="mgmt-requests-tab"><a href="#/requests">Requests</a></li>
              <li id="mgmt-history-tab"><a href="#/history">Log Event Records</a></li>
              <!--<li id="mgmt-settings-tab"><a href="#/settings">Settings</a></li>-->
            </ul>
            <div class="tab-content">
              <div class="tab-pane active" id="mgmt-users">
                <h3>Users</h3>
                <div id="mgmt-users-list"></div>
              </div>
              <div class="tab-pane" id="mgmt-invites">
                <h3>Invite a User</h3>
                <div>
                    <div class="input-append buttons-section">
                      <input class="span5" id="invited-user-email" type="text" placeholder="Email Address">
                      <button class="btn" type="button" id="send-invitation">Send Invitation</button>
                    </div>
                    <div class="loading buttons-section" style="display:none">
                        Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
                    </div>
                </div>
                <h3>Users Pending Registration</h3>
                <div id="mgmt-invites-list"></div>
              </div>
              <div class="tab-pane" id="mgmt-requests">
                <h3>Users Requesting for Invitation</h3>
                <div id="mgmt-requests-list"></div>
              </div>
                <div class="tab-pane" id="mgmt-history">
                    <h3>Log Event Records</h3>
                    <div id="mgmt-history-list"></div>
                </div>
              <div class="tab-pane" id="mgmt-settings">
                <h3>Settings</h3>
                <div>
                    <dl class="dl-horizontal"></dl>
                    <button class="btn" type="button" id="save-settings">Save Settings</button>
                </div>
              </div>
            </div>
        </div>
        <div class="span1"></div>
    </div>
</div>
<div id="admin-details" class="page hidden">
    <div class="row-fluid">
        <div class="span1"></div>
        <div class="span10 page-view"></div>
        <div class="span1"></div>
    </div>
</div>

<div id="loadingBar">
    <div id="loadingContent">
        Loading resources, please wait..
        <div class="progress progress-striped active">
            <div class="bar" style="width:50%;"></div>
        </div>
    </div>
</div>
<div id="download-container" class="hidden"></div>
<!-- views start -->
<script id="SettingsView" type="text/template">
                      <dt>Maximum Invitations</dt>
                      <dd><input name="maxInvitations" type="text" value="<%- settings.maxInvitations %>"></dd>
</script>
<script id="AdminUserDetailsView" type="text/template">
            <h3>User: <%- model.name %></h3>
                <div class="buttons-section">
                    <button did="delete-user" type="button" class="btn">Delete User</button>
<% if(model.accounts){ %>
                    <button did="deactivate-account" type="button" class="btn btn-primary" <% if(!model.accounts[0].magnetActive){ %>style="display:none"<% } %>>Deactivate Account</button>
                    <button did="activate-account" type="button" class="btn btn-primary" <% if(model.accounts[0].magnetActive){ %>style="display:none"<% } %>>Activate Account</button>
<% } %>
                </div>
                <div class="loading buttons-section" style="display:none">
                    Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
                </div>
            <hr />
            <div class="row-fluid">
                <div class="span12">
                    <h4>User Information</h4>
                    <table class="table table-striped">
                        <tbody>
                            <tr>
                                <td width="5px">Name</td>
                                <td width="5px"><%- model.name %></td>
                            </tr>
                            <tr>
                                <td width="5px">Email Address</td>
                                <td width="5px"><%- model.primaryEmailAddress %></td>
                            </tr>
                            <tr>
                                <td width="5px">Magnet Id</td>
                                <td width="5px"><%- model.magnetId %></td>
                            </tr>
                            <tr>
                                <td>Security Groups</td>
                                <td>
<% if(model.securityGroups){ %>
<% _.each(model.securityGroups, function(securitygroup, i){ %>
                                Name: <b><%- securitygroup.name %></b><br />
                                Description: <%- securitygroup.description %><br />
                                Distinguished Name: <%- securitygroup.distinguishedName %>
                                <% if(model.securityGroups.length > (i+1)){ %><hr /><% } %>
<% }); %>
<% } %>
                                </td>
                            </tr>
                            <tr>
                                <td>Accounts</td>
                                <td>
<% if(model.accounts){ %>
<% _.each(model.accounts, function(account, i){ %>
                                Name: <b><%- account.name %></b><br />
                                Authority: <%- account.authority %><br />
                                State: <b><span id="account-activation-state"><%- account.magnetActive ? 'Activated' : 'Deactivated' %></span></b><br />
                                <% if(model.accounts.length > (i+1)){ %><hr /><% } %>
<% }); %>
<% } %>
                                </td>
                            </tr>
                            <tr>
                                <td>Magnet Logic Projects</td>
                                <td>
<% if(model.olsprojects){ %>
<% _.each(model.olsprojects, function(olsproject, i){ %>
                                Name: <b><%- olsproject.name %></b><br />
                                Description: <b><%- olsproject.description %></b><br />
                                Package Name: <b><%- olsproject.packageName %></b><br />
                                Group Id: <%- olsproject.groupId %><br />
                                Artifact Id: <%- olsproject.artifactId %><br />
                                Created On: <%- olsproject.createdTime %><br />
                                Status: <%- olsproject.assetStatus %><br />
                                Version: <%- olsproject.version %>
                                <% if(model.olsprojects.length > (i+1)){ %><hr /><% } %>
<% }); %>
<% } %>
                                </td>
                            </tr>
                            <tr>
                                <td>Profile</td>
                                <td>
<% if(model.profile){ %>
                                First Name: <b><%- model.profile.firstName %></b><br />
                                Last Name: <b><%- model.profile.lastName %></b><br />
                                Name: <b><%- model.profile.name %></b>
<% } %>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <a href="#/users" class="main-btn btn">Back to Administration Page</a>
                </div>
            </div>
</script>
<script id="AdminContactDetailsView" type="text/template">
            <h3>User: <%- model.userInfo.name %></h3>
            <div class="buttons">
                <div class="buttons-section">
                    <button did="delete-contact" type="button" class="btn">Delete User</button>
<% if(page == 'requests'){ %>
                    <button did="approve-contact" type="button" class="btn btn-primary">Approve User</button>
                    <button did="deny-contact" type="button" class="btn btn-primary">Deny User</button>
<% } %>
                </div>
                <div class="loading buttons-section" style="display:none">
                    Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
                </div>

            </div>
            <hr />
            <div class="row-fluid">
                <div class="span12">
                    <h4>User Information</h4>
                    <table class="table table-striped">
                        <tbody>
                            <tr>
                                <td width="5px">Name</td>
                                <td width="5px"><%- model.userInfo.firstName %> <%- model.userInfo.lastName %></td>
                            </tr>
                            <tr>
                                <td width="5px">Email Address</td>
                                <td width="5px"><%- model.userInfo.name %></td>
                            </tr>
                            <tr>
                                <td width="5px">Company Name</td>
                                <td width="5px"><%- model.userInfo.companyName %></td>
                            </tr>
                            <tr>
                                <td width="5px">Created On</td>
                                <td width="5px"><%- model.formattedCreationDate %></td>
                            </tr>
                            <tr>
                                <td width="5px">Registration Task Id</td>
                                <td width="5px"><%- model.magnetId %></td>
                            </tr>
                            <tr>
                                <td width="5px">Source of Registration</td>
                                <td width="5px"><%- model.registrationType %></td>
                            </tr>
<% if(model.invitedBy){ %>
                            <tr>
                                <td width="5px">Invited By</td>
                                <td width="5px">
                                    <b>Name</b>: <%- model.invitedBy.firstName %> <%- model.invitedBy.lastName %><br />
                                    <b>Email Address</b>: <%- model.invitedBy.eMails[0] %>
                                </td>
                            </tr>
<% } %>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span12">
                    <a href="#/<%- page %>" class="main-btn btn">Back to Administration Page</a>
                </div>
            </div>
</script>
<script id="AdminLogDetailsView" type="text/template">
    <h3>Log: <%- model.magnetId %></h3>
    <div class="buttons-section"></div>
    <div class="loading buttons-section" style="display:none">
        Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
    </div>
    <hr />
    <div class="row-fluid">
        <div id="log-details-container" class="span12">

            <a id="log-event-link"></a><h4>Log Details</h4>
            <table class="table table-bordered table-striped table-hover">
                <% _.each(model, function(attr, key){ %>
                <% if(key != 'actor' && key != 'object' && key != 'context' && key != 'settings'){ %>
                <tr>
                    <td width="20%"><%- key %></td>
                    <% if(key.toLowerCase().indexOf('time') != -1){ %>
                    <td><%- utils.ISO8601ToDT(attr) %></td>
                    <% }else if(key == 'attachment'){ %>
                    <td><a class="btn btn-primary" href="/rest/log-event-records/<%- model.magnetId %>/attachment"><i class="icon-file icon-white"></i> Download Server Log</a></td>
                    <% }else{ %>
                    <td><%- attr %></td>
                    <% } %>
                </tr>
                <% } %>
                <% }); %>
            </table>

            <a id="log-actor-link"></a><h4>Actor</h4>
            <% if(model.actor){ %>
            <table class="table table-bordered table-striped table-hover">
                <% _.each(model.actor, function(attr, key){ %>
                <tr>
                    <td width="20%"><%- key %></td>
                    <% if(key.toLowerCase().indexOf('time') != -1 || key == 'lastStatusCheck'){ %>
                    <td><%- utils.ISO8601ToDT(attr) %></td>
                    <% }else{ %>
                    <td><%- attr %></td>
                    <% } %>
                </tr>
                <% }); %>
            </table>
            <% }else{ %>
            <p>No Actor Available.</p>
            <% } %>

            <a id="log-context-link"></a><h4>Context</h4>
            <% if(model.context){ %>
            <table class="table table-bordered table-striped table-hover">
                <% _.each(model.context, function(attr, key){ %>
                <tr>
                    <td width="20%"><%- key %></td>
                    <% if(key.toLowerCase().indexOf('time') != -1 || key == 'lastStatusCheck'){ %>
                    <td><%- utils.ISO8601ToDT(attr) %></td>
                    <% }else{ %>
                    <td><%- attr %></td>
                    <% } %>
                </tr>
                <% }); %>
            </table>
            <% }else{ %>
            <p>No Context Available.</p>
            <% } %>

            <a id="log-object-link"></a><h4>Object</h4>
            <% if(model.object){ %>
            <table class="table table-bordered table-striped table-hover">
                <% _.each(model.object, function(attr, key){ %>
                <tr>
                    <td width="20%"><%- key %></td>
                    <% if(key.toLowerCase().indexOf('time') != -1 || key == 'lastStatusCheck'){ %>
                    <td><%- utils.ISO8601ToDT(attr) %></td>
                    <% }else{ %>
                    <td><%- attr %></td>
                    <% } %>
                </tr>
                <% }); %>
            </table>
            <% }else{ %>
            <p>No Object Available.</p>
            <% } %>

            <hr />

            <a id="log-project-details-link"></a><h4>Project</h4>
            <div id="log-project-details-container"></div>

            <a id="log-project-settings-link"></a><h4>Project Settings</h4>
            <div id="log-project-settings-container"></div>

            <a id="log-project-assets-link"></a><h4>Project Assets</h4>
            <div id="log-project-assets-container"></div>

        </div>
    </div>
    <div class="row-fluid">
        <div class="span12">
            <a href="#/users" class="main-btn btn">Back to Administration Page</a>
        </div>
    </div>
</script>
<script id="AdminLogProjectDetailsView" type="text/template">
    <table class="table table-bordered table-striped table-hover">
        <% _.each(model, function(attr, key){ %>
            <tr>
                <td width="20%"><%- key %></td>
                <% if(key.toLowerCase().indexOf('time') != -1 || key == 'lastStatusCheck'){ %>
                <td><%- utils.ISO8601ToDT(attr) %></td>
                <% }else{ %>
                <td><%- attr %></td>
                <% } %>
            </tr>
        <% }); %>
    </table>
</script>
<script id="AdminLogProjectAssetsView" type="text/template">
    <table class="table">
        <% _.each(col, function(model, id){ %>
        <tr>
            <td width="20%"><b><%- model.description %></b></td>
            <td>
                <table class="table table-bordered table-striped table-hover">
                <% _.each(model, function(attr, key){ %>
                    <tr>
                        <td width="20%"><%- key %></td>
                        <% if(key.toLowerCase().indexOf('date') != -1){ %>
                            <td><%- utils.ISO8601ToDT(attr) %></td>
                        <% }else{ %>
                            <td><%- attr %></td>
                        <% } %>
                    </tr>
                <% }); %>
                    <tr>
                        <td colspan="2"><a class="btn btn-primary" href="<%- model['magnet-uri'].replace('magnet:', '/rest')+'/data' %>" target="_blank">Download <%- model.description %></a></td>
                    </tr>
                </table>
            </td>
        </tr>
        <% }); %>
    </table>
</script>
<script id="AdminContactDetailsView" type="text/template">
    <h3>User: <%- model.userInfo.name %></h3>
    <div class="buttons">
        <div class="buttons-section">
            <button did="delete-contact" type="button" class="btn">Delete User</button>
            <% if(page == 'requests'){ %>
            <button did="approve-contact" type="button" class="btn btn-primary">Approve User</button>
            <button did="deny-contact" type="button" class="btn btn-primary">Deny User</button>
            <% } %>
        </div>
        <div class="loading buttons-section" style="display:none">
            Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
        </div>

    </div>
    <hr />
    <div class="row-fluid">
        <div class="span12">
            <h4>User Information</h4>
            <table class="table table-striped">
                <tbody>
                <tr>
                    <td width="5px">Name</td>
                    <td width="5px"><%- model.userInfo.firstName %> <%- model.userInfo.lastName %></td>
                </tr>
                <tr>
                    <td width="5px">Email Address</td>
                    <td width="5px"><%- model.userInfo.name %></td>
                </tr>
                <tr>
                    <td width="5px">Company Name</td>
                    <td width="5px"><%- model.userInfo.companyName %></td>
                </tr>
                <tr>
                    <td width="5px">Created On</td>
                    <td width="5px"><%- model.formattedCreationDate %></td>
                </tr>
                <tr>
                    <td width="5px">Registration Task Id</td>
                    <td width="5px"><%- model.magnetId %></td>
                </tr>
                <tr>
                    <td width="5px">Source of Registration</td>
                    <td width="5px"><%- model.registrationType %></td>
                </tr>
                <% if(model.invitedBy){ %>
                <tr>
                    <td width="5px">Invited By</td>
                    <td width="5px">
                        <b>Name</b>: <%- model.invitedBy.firstName %> <%- model.invitedBy.lastName %><br />
                        <b>Email Address</b>: <%- model.invitedBy.eMails[0] %>
                    </td>
                </tr>
                <% } %>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row-fluid">
        <div class="span12">
            <a href="#/<%- page %>" class="main-btn btn">Back to Administration Page</a>
        </div>
    </div>
</script>
<script id="tableTmplView" type="text/template">
<% if(!disableControls){ %>
<% if(!hideSearch){ %>
                                    <div class="input-append">
                                        <div class="input-container">
                                            <input type="text" maxlength="200" placeholder="Search for...">
                                        </div>
                                        <div class="btn-group">
                                            <button class="btn btn-clear" type="button" style="display:none">Clear <i class="icon-remove"></i></button>
                                            <button class="btn dropdown-toggle">
                                                <span class="searchby-text">Search By<% if(searchBy){ %>: <%- headers[searchBy] %><% } %></span>
                                                <span class="caret"></span>
                                            </button>
                                            <button class="btn btn-primary" type="button">Search</button>
                                            <ul class="dropdown-menu">
<% _.each(headers, function(header, key){ %>
                                                <% if(key != 'profileName' && key != 'accountMagnetActive'){ %><li<% if(key == searchBy){ %> class="active"<% } %>><a href="#" p="<%- key %>"><%- header %><% } %></a></li>
<% }); %>
                                            </ul>
                                        </div>
                                    </div>
<% } %>
                                    <p>Click the column heading to sort in ascending or descending order. Click X to remove the Sort order. </p>
                                    <ul class="breadcrumb">
                                        Sort Order: <span></span>
                                    </ul>
<% } %>
                                    <table class="table table-striped table-hover table-bordered">
                                      <thead>
                                        <tr>
<% _.each(headers, function(header, key){ %>
                                            <th <% if(key != 'profileName' && key != 'accountMagnetActive'){ %>p="<%- key %>"<% } %>><%- header %><span class=""></span></th>
                                            <% }); %>
<% if(!disableInfo){ %>  
                                            <th class="listview-details">Details</th> 
<% } %>
                                        </tr>
                                      </thead>
                                      <tbody></tbody>
                                    </table>
                                    <div class="pagination"></div>
</script>
<script id="tableItemView" type="text/template">
<% _.each(collection, function(model, key){ %>
                                        <tr data-id="<%- model.attributes.magnetId %>">
<% _.each(headers, function(header, key){ %>
                                          <td><% if(model.attributes[key]){ %><% if(model.attributes[key].length > 0){ %><%= model.attributes[key] %><% } %><% } %></td>
<% }); %>
<% if(!disableInfo){ %>  
                                          <td><button class="btn">Details</button></td> 
<% } %>
                                        </tr>
<% }); %>
</script>
<script id="paginationDetailView" type="text/template">
<% if(paging.totalSize > 10){ %>  
    <ul>
        <li <% if(paging.startIndex == 0){ %>class="disabled"<% } %>><a href="#" page="<%-paging.previous%>">Prev</a></li>
<% for(i=0;i<paging.totalSize;i+=10){ %>
        <li <% if(paging.startIndex == i){ %>class="disabled"<% } %> ><a href="#" page="<%-i/10%>"><%-(i/10)+1%></a></li>
<% } %>  
        <li <% if(!paging.next || paging.startIndex == 90 || (paging.startIndex+paging.pageSize) == paging.totalSize){ %>class="disabled"<% } %>><a href="#" page="<%-paging.next%>">Next</a></li>  
    </ul>
    <% if(paging.startIndex == 90 && paging.totalSize == 100){ %>
       <br >The maximum number of results returned has been reached. Please refine your result with search or sort.
    <% } %> 
<% } %>   
</script>

<!-- dialogs start -->
<div id="error-alert" class="modal-form-errors modal hide fade">
	<div class="modal-header">
		<button data-dismiss="modal" class="close">x</button>
		<h3></h3>
	</div>
	<div class="modal-body">
		<p class="subheading">
		</p>
		<ul>
		</ul>
	</div>
	<div class="modal-footer">
		<button data-dismiss="modal" class="btn btn-primary">OK</button>
	</div>
</div>
<div id="general-alert" class="modal-alert modal hide fade">
	<div class="modal-header">
		<button data-dismiss="modal" class="close">x</button>
		<h3></h3>
	</div>
	<div class="modal-body">
		<p>
		</p>
	</div>
	<div class="modal-footer">
		<button data-dismiss="modal" id="ok" class="btn btn-primary">OK</button>
	</div>
</div>
<div id="confirm-alert" class="modal-confirm modal hide fade">
	<div class="modal-header">
		<button data-dismiss="modal" class="close">x</button>
		<h3></h3>
	</div>
	<div class="modal-body">
		<p>
		</p>
	</div>
	<div class="modal-footer">
		<button data-dismiss="modal" class="cancel btn">Cancel</button>
        <button class="submit btn-primary btn">Continue</button>
	</div>
</div>
<!-- dialogs end -->

</body>
</html>