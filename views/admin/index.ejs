
<div id="admin" class="page">
    <ul class="nav nav-tabs">
        <li id="mgmt-overview-tab" class="active"><a href="#/overview">Overview</a></li>
        <li id="mgmt-users-tab" class="active"><a href="#/users">Accounts</a></li>
        <li id="mgmt-events-tab"><a href="#/events">Logs</a></li>
        <li id="mgmt-cms-tab"><a href="#/cms">Templates</a></li>
        <li id="mgmt-actions-tab"><a href="#/actions">Configuration</a></li>
        <!--<li id="mgmt-messaging-tab"><a href="#/messaging">Messaging Configuration</a></li>-->
    </ul>
    <div class="tab-content fullpos">
        <div class="tab-pane clearfix active" id="mgmt-overview">
        </div>
        <div class="tab-pane clearfix" id="mgmt-users">
            <div class="radio-select">
                <div>
                    <input type="radio" class="clearfix" name="mgmt-user-creation-radio" value="mgmt-user-creation-manual" />
                    <span class="radio-select-title">Create an Account</span>
                </div>
                <div id="mgmt-user-creation-manual" class="admin-config-item-container radio-item-container">
                    <div class="buttons-section">
                        <span class="alert-container"></span>
                        <div class="form-group clearfix">
                            <div class="col-sm-3">
                                <label>Email</label>
                                <input type="text" name="email" class="form-control" placeholder="Email" value="" />
                            </div>
                            <div class="col-sm-3">
                                <label>Password</label>
                                <input type="password" name="password" class="form-control" placeholder="Password" value="" />
                            </div>
                            <div class="col-sm-3">
                                <label>Type</label>
                                <select class="form-control"  name="userType">
                                    <option value="developer">developer</option>
                                    <option value="admin">admin</option>
                                </select>
                            </div>
                            <div class="col-sm-3">
                                <div class="button-group clearfix">
                                    <button id="admin-user-create-btn" class="btn btn-primary">Create</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="loading buttons-section" style="display:none">
                        Loading.. Please Wait.. <img src="/admin/images/ajax-loader-sm.gif" />
                    </div>
                </div>
                <div id="mgmt-user-creation-invite-radio">
                    <input type="radio" class="clearfix" name="mgmt-user-creation-radio" value="mgmt-user-creation-invite" />
                    <span class="radio-select-title">Send a Magnet Message Invite <i class="glyphicon glyphicon-info-sign" title="" data-placement="right" data-toggle="tooltip" data-title="This invites a developer to the Magnet Message Application Console. The Email service must be enabled and configured to use this feature."></i></span>
                </div>
                <div id="mgmt-user-creation-invite" class="hidden admin-config-item-container radio-item-container">
                    <div class="buttons-section">
                        <div class="form-group clearfix">
                            <div class="col-sm-5">
                                <label>Email</label>
                                <input class="form-control" id="invited-user-email" type="text" placeholder="Email Address">
                            </div>
                            <div class="col-sm-7">
                                <div class="button-group clearfix">
                                    <button class="btn btn-primary" id="send-invitation">Send Invitation</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="loading buttons-section" style="display:none">
                        Loading.. Please Wait.. <img src="/admin/images/ajax-loader-sm.gif" />
                    </div>
                </div>
            </div>
            <hr />
            <h3>Accounts</h3>
            <div id="mgmt-users-list" class="listview"></div>
        </div>
        <div class="tab-pane clearfix" id="mgmt-user-details">
            <a href="#/users" class="glyphicon glyphicon-arrow-left"></a><h3 class="inline"> | Account Information</h3>
            <div id="mgmt-user-user-details"></div>
            <!--<h3>Magnet Message Apps</h3>-->
            <!--<div id="mmxapp-list-container"></div>-->
            <!--<div class="buttons hidden">-->
                <!--<div class="buttons-section">-->
                    <!--<button did="deactivate-user" type="button" class="btn btn-primary <% if(model.activated !== true){ %>hidden<% } %>">Deactivate User</button>-->
                    <!--<button did="activate-user" type="button" class="btn btn-primary <% if(model.activated === true){ %>hidden<% } %>">Activate User</button>-->
                    <!--<% if(model.userType == 'guest'){ %>-->
                    <!--<button did="approve-user" type="button" class="btn btn-primary">Approve User</button>-->
                    <!--<% } %>-->
                    <!--<% if(model.userType == 'approved'){ %>-->
                    <!--<button did="resend-registration=email" type="button" class="btn btn-primary">Resend Registration Email</button>-->
                    <!--<% } %>-->
                <!--</div>-->
            <!--</div>-->
        </div>
        <div class="tab-pane clearfix" id="mgmt-events">
            <div class="admin-configuration-container"></div>
            <div id="mgmt-events-list" class="listview"></div>
        </div>
        <div class="tab-pane clearfix" id="mgmt-cms">
            <h3>Email Templates</h3>
            <div class="row-fluid">
                <div id="" class="col-md-3">
                    <h5>Templates</h5>
                    <div id="cms-menu"></div>
                </div>
                <div class="col-md-9">
                    <h5>
                        Editor  <span id="cms-content-title-span"></span>
                    </h5>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <!--<div id="cms-actions">-->
                                <!--<button did="edit" class="cms-button btn btn-primary">Edit Content</button>-->
                                <!--<button did="save" class="cms-editing-button btn btn-primary" style="display:none">Save Updates</button>-->
                                <!--<button did="preview" class="cms-editing-button btn btn-primary" style="display:none">Preview</button>-->
                                <!--<button did="cancel" class="cms-editing-button btn btn-default" style="display:none">Cancel</button>-->
                            <!--</div>-->
                            <div class="buttons">
                                <div class="buttons-section">
                                    <div did="readonly" class="btn-group" data-toggle="buttons">
                                        <span class="cms-edit glyphicon bluetxt glyphicon-pencil disableable"></span>
                                    </div>
                                    <div class="btn-group btn-toggle" did="edittype">
                                        <button class="btn btn-sm disabled btn-primary active" did="preview" type="button">Preview</button>
                                        <button class="btn btn-sm disabled btn-default" did="code" type="button">Code</button>
                                    </div>
                                    <div did="readwrite" class="btn-group" data-toggle="buttons">
                                        <span did="save" class="cms-save glyphicon greentxt glyphicon-ok-circle disabled disableable"></span>
                                        <span did="cancel" class="cms-canceledit glyphicon redtxt glyphicon-remove-circle disabled disableable"></span>
                                    </div>
                                </div>
                                <div class="loading buttons-section" style="display:none">
                                    Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
                                </div>
                            </div>
                        </div>
                        <div class="panel-body">
                            <div id="cms-content">
                                <div id="cms-editable-section" style="display:none"></div>
                                <iframe id="cms-preview"></iframe>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane clearfix" id="mgmt-actions">
            <button id="admin-config-reset-btn" class="btn btn-primary pull-right">Reset</button>
            <h3>Configuration</h3>
            <div class="alert alert-info" role="alert">
                <strong>Note:</strong> Certain changes made to the configuration below will initiate a restart of the server.
            </div>
            <div class="admin-configuration-container"></div>
        </div>
        <div class="tab-pane clearfix" id="mgmt-messaging">
            <a href="/" class="btn btn-primary pull-right hidden-xs">Go to Magnet Message Application Console</a>
            <h3>Magnet Message Configuration</h3>
            <div class="admin-config-item-container" did="MMX">
                <div class="buttons-section">
                    <span class="alert-container"></span>
                    <div id="admin-mmx-configuration-container" class="form-group clearfix"></div>
                    <hr />
                    <div class="button-group clearfix">
                        <button class="admin-config-save-btn btn btn-primary">Save</button>
                    </div>
                </div>
                <div class="loading buttons-section" style="display:none">
                    Loading.. Please Wait.. <img src="/admin/images/ajax-loader-sm.gif" />
                </div>
            </div>
        </div>
    </div>
</div>

<div id="loadingBar">
    <div id="loadingContent">
        Loading resources, please wait..
        <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
            <span class="sr-only"></span>
        </div>
    </div>
</div>
<div id="download-container" class="hidden"></div>


<!-- views start -->
<script id="AdminOverviewTmpl" type="text/template">

    <h5>Status</h5>
    <div class="panel panel-default form-group clearfix">
        <div class="col-sm-3">
            <label>Messaging Server Status</label>
            <div class="messaging-connectivity-container"></div>
        </div>
    </div>

    <h5>Environment</h5>
    <div class="panel panel-default form-group clearfix">
        <div class="col-sm-3">
            <label>External Hostname</label>
            <span><%- mmxconfig['mmx.push.callbackurl'] %></span>
        </div>
        <div class="col-sm-3">
            <label>Internal Hostname</label>
            <span><%- configs.MMX.host %></span>
        </div>
        <div class="col-sm-3">
            <label>Domain</label>
            <span><%- mmxconfig['xmpp.domain'] %></span>
        </div>
        <div class="col-sm-3">
            <label>Log Directory</label>
            <span><%- configs.FileLog.folder %></span>
        </div>
    </div>

    <h5>Admin Server Database</h5>
    <div class="panel panel-default form-group clearfix">
        <div class="col-sm-3">
            <label>Database Name</label>
            <span><%- configs.Database.dbName %></span>
        </div>
        <div class="col-sm-3">
            <label>Host Hame</label>
            <span><%- configs.Database.host %></span>
        </div>
        <div class="col-sm-3">
            <label>Port</label>
            <span><%- configs.Database.port %></span>
        </div>
        <div class="col-sm-3">
            <label>Username</label>
            <span><%- configs.Database.username %></span>
        </div>
    </div>

    <h5>Messaging Server Database</h5>
    <div class="panel panel-default form-group clearfix">
        <div class="col-sm-3">
            <label>Database Name</label>
            <span><%- mmxconfig.dbName %></span>
        </div>
        <div class="col-sm-3">
            <label>Host Hame</label>
            <span><%- mmxconfig.host %></span>
        </div>
        <div class="col-sm-3">
            <label>Port</label>
            <span><%- mmxconfig.port %></span>
        </div>
        <div class="col-sm-3">
            <label>Username</label>
            <span><%- mmxconfig.username %></span>
        </div>
    </div>

    <% if(configs.Geologging.enabled){ %>
    <h5>Geo Tracking</h5>
    <div class="panel panel-default form-group clearfix">
        <div class="col-sm-3">
            <label>Port</label>
            <span><%- configs.Geologging.port %></span>
        </div>
        <div class="col-sm-3">
            <label>Status</label>
            <div class="geotracking-connectivity-container"></div>
        </div>
    </div>
    <% } %>

    <h5>Ports</h5>
    <div class="panel panel-default form-group clearfix">
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Protocol</th>
                <th>Port</th>
                <th>Name</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>HTTP</td>
                <td><%- mmxconfig['xmpp.socket.plain.port'] %></td>
                <td>Client Messaging</td>
            </tr>
            <tr>
                <td>HTTPS</td>
                <td><%- mmxconfig['xmpp.socket.ssl.port'] %></td>
                <td>Client Messaging</td>
            </tr>
            <tr>
                <td>HTTP</td>
                <td><%- configs.MMX.webPort %></td>
                <td>Web</td>
            </tr>
            <tr>
                <td>HTTPS</td>
                <td><%- mmxconfig['adminConsole.securePort'] %></td>
                <td>Web</td>
            </tr>
            <tr>
                <td>HTTP</td>
                <td><%- mmxconfig['mmx.rest.http.port'] %></td>
                <td>Public REST API</td>
            </tr>
            <tr>
                <td>HTTPS</td>
                <td><%- mmxconfig['mmx.rest.https.port'] %></td>
                <td>Public REST API</td>
            </tr>
            <tr>
                <td>HTTP</td>
                <td><%- mmxconfig['mmx.admin.api.port'] %></td>
                <td>Admin REST API</td>
            </tr>
            <tr>
                <td>HTTPS</td>
                <td><%- mmxconfig['mmx.admin.api.https.port'] %></td>
                <td>Admin REST API</td>
            </tr>
            </tbody>
        </table>
    </div>

</script>

<script id="AdminUserDetailsView" type="text/template">
    <div id="user-panel" class="panel panel-default">
        <div class="panel-heading">
            <div class="buttons">
                <div class="buttons-section">
                    <div did="readonly" class="btn-group" data-toggle="buttons">
                        <span id="mgmt-user-edit-btn" class="glyphicon bluetxt glyphicon-pencil disableable"></span>
                        <span id="mgmt-user-delete-btn" class="glyphicon redtxt glyphicon-trash"></span>
                    </div>
                    <div class="divider"></div>
                    <div did="readwrite" class="btn-group" data-toggle="buttons">
                        <span id="mgmt-user-save-btn" class="glyphicon greentxt glyphicon-ok-circle disabled disableable"></span>
                        <span id="mgmt-user-cancel-btn" class="glyphicon redtxt glyphicon-remove-circle disabled disableable"></span>
                    </div>
                </div>
                <div class="loading buttons-section" style="display:none">
                    Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
                </div>
            </div>
        </div>
        <div class="panel-body">
            <div class="form-group clearfix">
                <div class="row-fluid">
                    <div class="col-sm-6">
                        <label class="control-label">First Name</label>
                        <div class="controls">
                            <input type="text" class="form-control" disabled="disabled" name="firstName" value="<%-  model.firstName %>" placeholder="First Name">
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="control-label">Last Name</label>
                        <div class="controls">
                            <input type="text" class="form-control" disabled="disabled" name="lastName" value="<%-  model.lastName %>" placeholder="Last Name">
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="control-label">Email Address</label>
                        <div class="controls">
                            <span class="graytxt"><%- model.email %></span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="control-label">Account Status</label>
                        <div class="btn-group btn-toggle clearfix" did="activated">
                            <button class="btn btn-sm disabled <% if(model.activated === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Active</button>
                            <button class="btn btn-sm disabled <% if(typeof model.activated == 'undefined' || model.activated === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Blocked</button>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="control-label">Company</label>
                        <div class="controls">
                            <input type="text" class="form-control" disabled="disabled" name="companyName" value="<%-  model.companyName %>" placeholder="Company">
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="control-label">Role Within Company</label>
                        <div class="controls">
                            <input type="text" class="form-control" disabled="disabled" name="roleWithinCompany" value="<%-  model.roleWithinCompany %>" placeholder="Role Within Company">
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <label class="control-label">Type of User (Internal)</label>
                        <% if(model.userType == 'developer' || model.userType == 'admin'){ %>
                        <select class="form-control"  disabled="disabled" name="userType">
                            <option value="developer" <% if(model.userType == 'developer'){ %>selected="selected"<% } %>>developer</option>
                            <option value="admin" <% if(model.userType == 'admin'){ %>selected="selected"<% } %>>admin</option>
                        </select>
                        <% } %>
                    </div>
                    <div class="col-sm-<% if(model.invitedEmail){ %>2<% }else{ %>3<% } %>">
                        <label class="control-label">Created On</label>
                        <div class="controls">
                            <span class="graytxt"><%- model.createdAt %></span>
                        </div>
                    </div>
                    <div class="col-sm-<% if(model.invitedEmail){ %>2<% }else{ %>3<% } %>">
                        <label class="control-label">Last Updated</label>
                        <div class="controls">
                            <span class="graytxt"><%- model.updatedAt %></span>
                        </div>
                    </div>
                    <% if(model.invitedEmail){ %>
                    <div class="col-sm-<% if(model.invitedEmail){ %>2<% }else{ %>3<% } %>">
                        <label class="control-label">Invited By</label>
                        <div class="controls">
                            <span class="graytxt"><%- model.invitedEmail %></span>
                        </div>
                    </div>
                    <% } %>
                </div>
            </div>
            <div class="button-group">
                <button id="user-reset-password-btn" class="btn btn-primary">Reset Password</button>
            </div>
        </div>
    </div>
</script>
<script id="MMXAppListView" type="text/template">
    <% if(col && col.length > 0){ %>
        <div class="row-fluid">
        <% _.each(col, function(model, key){ %>
            <div class="col-sm-6">
                <div did="<%- model.attributes.appId %>" class="panel panel-default <% if(!model.attributes.appId){ %>hidden<% } %>">
                    <div class="panel-heading">
                        <div class="row-fluid clearfix">
                            <div class="col-sm-5">
                                <h4 class="panel-title">
                                <%- model.attributes.name %>
                                </h4>
                                <div class="panel-name hidden">
                                    <input type="text" class="form-control" name="name" value="<%- model.attributes.name %>">
                                </div>
                            </div>
                            <div class="col-sm-7">
                                <div class="buttons pull-right">
                                    <div class="buttons-section">
                                        <div did="readonly" class="btn-group" data-toggle="buttons">
                                            <span class="mmx-edit glyphicon bluetxt glyphicon-pencil disableable"></span>
                                            <span did="delete" id="mgmt-mmxapp-delete-btn" class="glyphicon redtxt glyphicon-trash"></span>
                                        </div>
                                        <div class="divider"></div>
                                        <div did="readwrite" class="btn-group" data-toggle="buttons">
                                            <span class="mmx-saveedit glyphicon greentxt glyphicon-ok-circle disabled disableable"></span>
                                            <span class="mmx-canceledit glyphicon redtxt glyphicon-remove-circle disabled disableable"></span>
                                        </div>
                                    </div>
                                    <div class="loading buttons-section" style="display:none">
                                        Loading.. Please Wait.. <img src="../images/ajax-loader-sm.gif" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel-body">
                        <div class="form-group">
                            <label>API Key</label>
                            <div class="controls">
                                <span class="graytxt"><%- model.attributes.appAPIKey %></span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Creation Date</label>
                            <div class="controls">
                                <span class="graytxt"><%- utils.fromISO8601(model.attributes.iso8601CreationDate) %></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <% }); %>
        </div>

    <% } %>
</script>
<script id="InvitedUsersListView" type="text/template">
    <% if(col && col.length > 0){ %>
    <td><h4>Invited Users</h4></td>
    <td>
        <table class="table table-bordered table-striped table-hover">
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Invited On</th>
            </tr>
            <tbody>
            <% _.each(col, function(user, i){ %>
                <tr>
                <td><%- user.attributes.profileName %></td>
                <td><%- user.attributes.email || user.attributes.invitedEmail %></td>
                <td><%- user.attributes.createdAt %></td>
            </tr>
            <% }); %>
            </tbody>
        </table>
    </td>
    <% } %>
</script>

<script id="CMSListView" type="text/template">
    <% if(col && col.length > 0){ %>
            <ul class="nav nav-list panel">
            <% var cached = ''; _.each(col, function(model, i){ %>
                <!--<% if(cached != model.folder){ cached = model.folder; %>-->
                <!--<li class="nav-header"><%- cached %></li>-->
                <!--<% } %>-->
                <li><a href="#" class="cmspage" folder="<%- model.folder %>" noLayout="<%- model.noLayout %>" filename="<%- model.filename %>"><%- model.filename %></a></li>
            <% }); %>
            </ul>
    <% }else{ %>
    No pages are available.
    <% } %>
</script>
<script id="tableTmplView" type="text/template">
<% if(!disableControls){ %>
    <div class="row-fluid clearfix">
        <div class="col-sm-6">
            <ul class="breadcrumb">
                Sort Order: <br />
                <span></span>
            </ul>
        </div>
        <div class="col-sm-6">
            <% if(!hideSearch){ %>
                <div class="input-append">
                    <div class="input-container">
                        <input type="text" class="form-control" maxlength="200" placeholder="Search for...">
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-default btn-clear" type="button" style="display:none">Clear <i class="glyphicon glyphicon-remove"></i></button>
                        <button class="btn btn-default dropdown-toggle">
                            <span class="searchby-text">Search By<% if(searchBy){ %>: <%- headers[searchBy] %><% } %></span>
                            <span class="caret"></span>
                        </button>
                        <button class="btn btn-primary" type="button"><span class="glyphicon glyphicon-search"></span></button>
                        <ul class="dropdown-menu">
            <% _.each(headers, function(header, key){ %>
                        <% if(key != 'profileName' && key != 'accountMagnetActive' && key != 'getConfig'){ %><li<% if(key == searchBy){ %> class="active"<% } %>><a href="#" p="<%- key %>"><%- header %><% } %></a></li>
            <% }); %>
                        </ul>
                    </div>
                </div>
            <% } %>
        </div>
    </div>
<% } %>
    <table class="table table-striped table-hover table-bordered">
        <thead>
            <tr>
                <% _.each(headers, function(header, key){ %>
                <th <% if(key != 'profileName' && key != 'accountMagnetActive' && key != 'getConfig'){ %>p="<%- key %>"<% } %>><%- header %><span class=""></span></th>
                <% }); %>
<% if(!disableInfo){ %>
                <th class="listview-details">Details</th>
<% } %>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <div class="pagination-container"></div>
</script>
<script id="tableItemView" type="text/template">
<% _.each(collection, function(model, key){ %>
    <tr data-id="<%- model.attributes.magnetId %>">
<% _.each(headers, function(header, key){ %>
        <% if(key == 'getConfig'){ %>
        <td><%= model.attributes['getConfig'] %></td>
        <% }else{ %>
        <td><% if(model.attributes[key]){ %><% if(model.attributes[key].length > 0){ %><%- model.attributes[key] %><% } %><% } %></td>
        <% } %>
<% }); %>
<% if(!disableInfo){ %>
         <td><a href="" class="listview-link">More Info</a></td>
<% } %>
    </tr>
<% }); %>
</script>
<script id="paginationDetailView" type="text/template">
<% if(paging.total > 10){ %>
    <ul class="pagination">
        <li <% if(paging.start == 0){ %>class="disabled"<% } %>><a href="#" page="<%-paging.previous%>">Prev</a></li>
<% if(paging.start > (paging.rpp * 5) && paging.total < (paging.start+60)){ %>
        <% for(i=Math.round((paging.total-110) / 10) * 10;i<paging.total;i+=paging.rpp){ if(i >= 0){ %>
        <li <% if(paging.start == i){ %>class="disabled"<% } %> ><a href="#" page="<%-i%>"><%-(i/10)+1%></a></li>
        <% } %>
<% } }else if(paging.start > (paging.rpp * 5)){ %>
        <% for(i=(paging.start-50);i<(paging.total < (paging.start+60) ? paging.total : (paging.start+60));i+=paging.rpp){ %>
        <li <% if(paging.start == i){ %>class="disabled"<% } %> ><a href="#" page="<%-i%>"><%-(i/10)+1%></a></li>
        <% } %>
<% }else{ %>
        <% for(i=0;i<(paging.total < 110 ? paging.total : 110);i+=paging.rpp){ %>
        <li <% if(paging.start == i){ %>class="disabled"<% } %> ><a href="#" page="<%-i%>"><%-(i/10)+1%></a></li>
        <% } %>
<% } %>
        <li <% if(!paging.next || (paging.start+paging.rpp) == paging.total){ %>class="disabled"<% } %>><a href="#" page="<%-paging.next%>">Next</a></li>
    </ul>
    <div class="pagination-captions">
        <%- paging.total %> records total. viewing records <%- (paging.start+1) %> to <%- (paging.total < (paging.start+paging.rpp) ? paging.total : (paging.start+paging.rpp)) %>.
    </div>
<% } %>
</script>
<!-- dialogs end -->

<script id="AdminConfigurationTmpl" type="text/template">
    <div class="panel-group clearfix" id="admin-config-container-collapsible">
        <% _.each(allowed, function(key, i){ var val = configs[key] %>
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4 class="panel-title">
                    <a data-toggle="collapse" data-parent="#admin-config-container-collapsible" href="#admin-config-item-<%- key %>">
                        <%- key === 'Email' ? 'Email Settings' : key.replace('Log', ' Log Settings').replace('Alerts', ' Alerts')
                        .replace('App', 'System Administration Settings').replace('Geologging', 'Geo Tracking')
                        .replace('MMX', 'Magnet Message Connection Settings').replace('MessagingSettings', 'Messaging Settings')
                        .replace('Database', 'Magnet Message Database Settings') %>
                    </a>
                </h4>
            </div>
            <div id="admin-config-item-<%- key %>" class="panel-collapse collapse">
                <div class="panel-body">
                    <div class="admin-config-item-container" did="<%- key %>">
                        <div class="buttons-section">
                            <span class="alert-container"></span>
                            <div class="form-group clearfix">
                            <%= renderConfigItem(key, val, configs, featureConfigs[key]) %>
                            </div>
                            <hr />
                            <div class="button-group clearfix">
                                <button class="admin-config-save-btn btn btn-primary"><%- (key == 'MMX' ? 'Apply' : 'Save') %><%- (['Database', 'App', 'Redis'].indexOf(key) != -1) ? ' and Restart' : '' %></button>
                            </div>
                        </div>
                        <div class="loading buttons-section" style="display:none">
                            Loading.. Please Wait.. <img src="/admin/images/ajax-loader-sm.gif" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <% }); %>
    </div>
</script>
<script id="AdminConfigurationAppTmpl" type="text/template">
    <div class="col-sm-6">
        <label>Remote Url
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The Remote Url is the remote hostname of the Admin Console (should be accessible to Magnet Message users from a web browser)."></span>
        </label>
        <input type="text" name="appUrl" class="form-control" placeholder="App Url" value="<%- config.appUrl %>" />
    </div>
    <div class="col-sm-3">
        <label>Port
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The internal port of the Admin Console server (behind load balancer if applicable)."></span>
        </label>
        <input type="text" name="port" class="form-control" placeholder="Port" value="<%- config.port %>" />
    </div>
    <div class="col-sm-3">
        <label>Handle Exceptions
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="If enabled, uncaught exceptions will be caught and logged. This is useful for production environments."></span>
        </label>
        <div class="btn-group btn-toggle clearfix" did="handleExceptions">
            <button class="btn btn-sm <% if(config.handleExceptions === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">On</button>
            <button class="btn btn-sm <% if(typeof config.handleExceptions == 'undefined' || config.handleExceptions === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Off</button>
        </div>
    </div>
</script>
<script id="AdminConfigurationDatabaseTmpl" type="text/template">
    <p>Modify the System Administration Console database settings.</p>
    <div class="alert alert-danger" role="alert">
        <strong>Warning:</strong> If the database is changed, the new database must have at least one admin user in order to login.
    </div>
    <div class="col-sm-5">
        <label>Hostname</label>
        <input type="text" name="host" class="form-control" placeholder="Hostname" value="<%- config.host %>" />
    </div>
    <div class="col-sm-5">
        <label>Database Name</label>
        <input type="text" name="dbName" class="form-control" placeholder="Database Name" value="<%- config.dbName %>" />
    </div>
    <div class="col-sm-2">
        <label>Port</label>
        <input type="text" maxlength="10" name="port" class="form-control" placeholder="Port" value="<%- config.port %>" />
    </div>
    <div class="col-sm-6">
        <label>Username</label>
        <input type="text" name="username" class="form-control" placeholder="Username" value="<%- config.username %>" />
    </div>
    <div class="col-sm-6">
        <label>Password</label>
        <input type="password" name="password" class="form-control" placeholder="Password" value="" />
    </div>
</script>
<script id="AdminConfigurationRedisTmpl" type="text/template">
    <p>Redis can be used to share user session and configuration between multiple Admin Console nodes in a cluster. For a single
        Admin Console deployment, Redis allows modification of configuration without restart of server.</p>
    <div class="col-sm-4">
        <label>Enabled
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="A redis database can be used to store user sessions. This is required only if you wish to deploy the Admin Console server as a cluster."></span>
        </label>
        <div class="btn-group btn-toggle clearfix" did="enabled">
            <button class="btn btn-sm <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>
    <div class="col-sm-4">
        <label>Cache Timeout
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="Time in seconds before cached configuration is refreshed."></span>
        </label>
        <input type="text" name="cacheTimeout" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="time in seconds" value="<%- config.cacheTimeout %>" />
    </div>
    <div class="col-sm-4">
        <label>Port</label>
        <input type="text" maxlength="10" name="port" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Port" value="<%- config.port %>" />
    </div>
    <div class="col-sm-6">
        <label>Hostname</label>
        <input type="text" name="host" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Hostname" value="<%- config.host %>" />
    </div>
    <div class="col-sm-6">
        <label>Password</label>
        <input type="password" name="pass" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Password" value="" />
    </div>
</script>
<script id="AdminConfigurationConsoleLogTmpl" type="text/template">
    <p>System generated diagnostic logs can be output in terminal window.</p>
    <div class="col-sm-4">
        <label>Enabled</label>
        <div class="btn-group btn-toggle clearfix" did="enabled">
            <button class="btn btn-sm <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>
    <div class="col-sm-4">
        <label>Log Level</label>
        <select class="form-control" <%- config.enabled === true ? '' : 'disabled="disabled"' %> name="level">
            <% _.each(levels, function(val, key){ %>
            <option value="<%- val %>" <% if(config.level === val){ %>selected="selected"<% } %>><%- val %></option>
            <% }); %>
        </select>
    </div>
</script>
<script id="AdminConfigurationFileLogTmpl" type="text/template">
    <p>Generate system diagnostic logs saved as log files.</p>
    <div class="col-sm-4">
        <label>Enabled</label>
        <div class="btn-group btn-toggle clearfix" did="enabled">
            <button class="btn btn-sm <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>
    <div class="col-sm-4">
        <label>Log Level</label>
        <select class="form-control" <%- config.enabled === true ? '' : 'disabled="disabled"' %> name="level">
            <% _.each(levels, function(val, key){ %>
            <option value="<%- val %>" <% if(config.level === val){ %>selected="selected"<% } %>><%- val %></option>
            <% }); %>
        </select>
    </div>
    <div class="col-sm-4">
        <label>Folder
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The folder to write log files, relative to the root directory."></span>
        </label></label>
        <input type="text" name="folder" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Folder" value="<%- config.folder %>" />
    </div>
    <div class="col-sm-4">
        <label>Filename</label>
        <input type="text" name="filename" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Filename" value="<%- config.filename %>" />
    </div>
    <div class="col-sm-4">
        <label>Maximum Size
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The maximum log file size before logs are written to a new file."></span>
        </label>
        <input type="text" name="maxsize" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Maximum Size" value="<%- config.maxsize %>" />
    </div>
    <div class="col-sm-4">
        <label>Max Saved Files
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The maximum number of log files before logs are overwritten."></span>
        </label>
        <input type="text" name="maxFiles" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Maximum Files" value="<%- config.maxFiles %>" />
    </div>
</script>
<script id="AdminConfigurationEmailAlertsTmpl" type="text/template">
    <p>A recipient can be set up to receive alerts when a problem occurs.</p>
    <div class="col-sm-6 clearfix">
        <label>Enabled
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The Email feature must first be enabled and configured correctly before email logs can be sent."></span>
        </label>
        <div class="btn-group btn-toggle" did="enabled">
            <button class="btn btn-sm <% if(allConfigs.Email.enabled !== true){ %>disabled<%} %> <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(allConfigs.Email.enabled !== true){ %>disabled<%} %> <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>
    <div class="col-sm-6">
        <label>Alert Level</label>
        <select class="form-control" <%- config.enabled === true ? '' : 'disabled="disabled"' %> name="level">
            <% _.each(levels, function(val, key){ %>
            <% if(['warn', 'error'].indexOf(val) != -1){ %>
            <option value="<%- val %>" <% if(config.level === val){ %>selected="selected"<% } %>><%- val %></option>
            <% } %>
            <% }); %>
        </select>
    </div>
    <div class="col-sm-12">
        <label>Recipient</label>
        <input type="text" name="recipient" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Folder" value="<%- config.recipient %>" />
    </div>
</script>
<script id="AdminConfigurationDatabaseLogTmpl" type="text/template">
    <p>Certain administrative and messaging events can be written to MySQL database and displayed in the Logs. </p>
    <div class="col-sm-6 clearfix">
        <label>Enabled</label>
        <div class="btn-group btn-toggle clearfix" did="enabled">
            <button class="btn btn-sm <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>
    <div class="col-sm-6 clearfix">
        <label>Log Level</label>
        <select class="form-control" <%- config.enabled === true ? '' : 'disabled="disabled"' %> name="level">
            <% _.each(levels, function(val, key){ %>
            <% if(['silly'].indexOf(val) == -1){ %>
            <option value="<%- val %>" <% if(config.level === val){ %>selected="selected"<% } %>><%- val %></option>
            <% } %>
            <% }); %>
        </select>
    </div>
</script>
<script id="AdminConfigurationEmailTmpl" type="text/template">
    <p>Once email is set up properly, the email logging feature can be enabled and emails can be sent automatically to users during the registration process.</p>
    <div class="col-sm-4 clearfix">
        <label>Enabled</label>
        <div class="btn-group btn-toggle" did="enabled">
            <button class="btn btn-sm <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>
    <div class="col-sm-4 clearfix">
        <label>TLS</label>
        <div class="btn-group btn-toggle" did="tls">
            <button class="btn btn-sm <% if(config.tls === true){ %>btn-primary active<% }else{ %>btn-default<% } %> <%- config.enabled === true ? '' : 'disabled' %>" did="true" type="button">On</button>
            <button class="btn btn-sm <% if(typeof config.tls == 'undefined' || config.tls === false){ %>btn-primary active<% }else{ %>btn-default<% } %>  <%- config.enabled === true ? '' : 'disabled' %>" did="false" type="button">Off</button>
        </div>
    </div>
    <div class="col-sm-4">
        <label>Sender</label>
        <input type="text" name="sender" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="ender" value="<%- config.sender %>" />
    </div>
    <div class="col-sm-9">
        <label>Hostname</label>
        <input type="text" name="host" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Hostname" value="<%- config.host %>" />
    </div>
    <div class="col-sm-3">
        <label>Port</label>
        <input type="text" maxlength="10" name="port" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Port" value="<%- config.port %>" />
    </div>
    <div class="col-sm-6">
        <label>Username</label>
        <input type="text" name="user" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Username" value="<%- config.user %>" />
    </div>
    <div class="col-sm-6">
        <label>Password</label>
        <input type="password" name="password" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Password" value="" />
    </div>
</script>
<script id="AdminConfigurationGeologgingTmpl" type="text/template">
    <p>Enable geographical tracking to store user and device geographic locations to database.</p>
    <div class="col-sm-4 clearfix">
        <label>Enabled</label>
        <div class="btn-group btn-toggle" did="enabled">
            <button class="btn btn-sm <% if(config.enabled === true){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="true" type="button">Enabled</button>
            <button class="btn btn-sm <% if(typeof config.enabled == 'undefined' || config.enabled === false){ %>btn-primary active<% }else{ %>btn-default<% } %>" did="false" type="button">Disabled</button>
        </div>
    </div>

    <div class="col-sm-4">
        <label>Connection State</label>
        <div class="geotracking-connectivity-container"></div>
    </div>
    <div class="col-sm-4">
        <label>Service Domain</label>
        <input type="text" name="servername" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Service Domain" value="<%- config.servername %>" />
    </div>
    <div class="col-sm-4">
        <label>Service Id</label>
        <input type="text" name="jid" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Service Id" value="<%- config.jid %>" />
    </div>
    <div class="col-sm-4">
        <label>Hostname</label>
        <input type="text" name="host" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Hostname" value="<%- config.host %>" />
    </div>
    <div class="col-sm-4">
        <label>Secret Key</label>
        <div class="toggling-password-input">
            <span class="glyphicon glyphicon-eye-close hidden" title="" data-placement="top" data-toggle="tooltip" data-title="Click the eye to hide the password value."></span>
            <span class="glyphicon glyphicon-eye-open" title="" data-placement="top" data-toggle="tooltip" data-title="Click the eye to display the password value."></span>
            <input type="password" name="secretkey" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control toggling-password-input" placeholder="Secret Key" value="<%- config.secretkey %>" />
        </div>
    </div>
    <div class="col-sm-3">
        <label>Port</label>
        <input type="text" maxlength="10" name="port" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="Port" value="<%- config.port %>" />
    </div>
    <div class="col-sm-3">
        <label>Flush Interval
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="To improve performance, set the amount of geolocation cache entries before they are stored to database."></span>
        </label>
        <input type="text" maxlength="10" name="flushInterval" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="number of entries" value="<%- config.flushInterval %>" />
    </div>
    <div class="col-sm-3">
        <label>Expiration Timeout
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The time in minutes before a geolocation record is considered outdated and removed from the database."></span>
        </label>
        <input type="text" maxlength="10" name="expirationTimeout" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="time in minutes" value="<%- config.expirationTimeout %>" />
    </div>
    <div class="col-sm-3">
        <label>Cleanup Interval
            <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The interval in minutes when the database should be inspected to check for outdated geolocation records."></span>
        </label>
        <input type="text" maxlength="10" name="cleanupInterval" <%- config.enabled === true ? '' : 'disabled="disabled"' %> class="form-control" placeholder="time in minutes" value="<%- config.cleanupInterval %>" />
    </div>
</script>
<script id="AdminConfigurationMMXTmpl" type="text/template">
    <div did="mmx-connect" class="form-group clearfix">
        <div class="col-sm-6">
            <label>Hostname</label>
            <input type="text" name="host" class="form-control" placeholder="Hostname" value="<%- config.host %>" />
        </div>
        <div class="col-sm-2">
            <label>Web Port</label>
            <input type="text" maxlength="10" name="webPort" class="form-control" placeholder="Port" value="<%- config.webPort %>" />
        </div>
        <div class="col-sm-2">
            <label>Public HTTP REST API Port</label>
            <input type="text" maxlength="10" name="publicPort" class="form-control" placeholder="Public HTTP REST API Port" value="<%- config.publicPort %>" />
        </div>
        <div class="col-sm-2">
            <label>Admin HTTP REST API Port</label>
            <input type="text" maxlength="10" name="adminPort" class="form-control" placeholder="Admin HTTP REST API Port" value="<%- config.adminPort %>" />
        </div>
        <div class="col-sm-6">
            <label>Username</label>
            <input type="text" name="user" class="form-control" placeholder="Username" value="<%- config.user %>" />
        </div>
        <div class="col-sm-6">
            <label>Password</label>
            <div class="toggling-password-input">
                <span class="glyphicon glyphicon-eye-close hidden" title="" data-placement="top" data-toggle="tooltip" data-title="Click the eye to hide the password value."></span>
                <span class="glyphicon glyphicon-eye-open" title="" data-placement="top" data-toggle="tooltip" data-title="Click the eye to display the password value."></span>
                <input type="password" name="password" class="form-control toggling-password-input" placeholder="Password" value="<%- config.password %>" />
            </div>
        </div>
    </div>
    <p><a href="/">Go to Magnet Message Application Console</a></p>
</script>

<script id="AdminConfigurationMessagingSettingsTmpl" type="text/template">
    <% if(config){ %>
    <div did="mmx-config" class="form-group clearfix">
        <div class="row-fluid clearfix">
            <div class="col-sm-8">
                <label>External Hostname
                    <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The public url to be used by mobile clients for acknowledging push notifications."></span>
                </label>
                <input type="text" name="mmx.push.callbackurl" class="form-control" placeholder="A public url" value="<%- config['mmx.push.callbackurl'] %>" />
            </div>
        </div>
        <div class="row-fluid">
            <div class="col-sm-2">
                <label>Wakeup Frequency
                    <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="Frequency in seconds for sending a wakeup to a device."></span>
                </label>
                <input type="text" maxlength="10" name="mmx.wakeup.frequency" class="form-control" placeholder="Frequency in seconds" value="<%- config['mmx.wakeup.frequency'] %>" />
            </div>
            <div class="col-sm-2">
                <label>Retry Interval
                    <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The time interval in minutes between consecutive message retry attempts."></span>
                </label>
                <input type="text" maxlength="10" name="mmx.retry.interval.minutes" class="form-control" placeholder="Time interval in minutes" value="<%- config['mmx.retry.interval.minutes'] %>" />
            </div>
            <div class="col-sm-2">
                <label>Retry Count
                    <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The count for the number of times a message delivery will be attempted."></span>
                </label>
                <input type="text" maxlength="10" name="mmx.retry.count" class="form-control" placeholder="message rate" value="<%- config['mmx.retry.count'] %>" />
            </div>
            <div class="col-sm-2">
                <label>Timeout Period
                    <span class="glyphicon glyphicon-info-sign" title="" data-placement="top" data-toggle="tooltip" data-title="The time period in minutes after which server will stop attempting to deliver message."></span>
                </label>
                <input type="text" maxlength="10" name="mmx.timeout.period.minutes" class="form-control" placeholder="Timeout period in minutes" value="<%- config['mmx.timeout.period.minutes'] %>" />
            </div>
        </div>
    </div>
    <% }else{ %>
    <div class="alert alert-danger" role="alert">
        Unable to connect to Magnet Message with the Magnet Message Connectivity parameters you provided. Please change the parameters and try again.
    </div>
    <% } %>
</script>

